/pytorch/aten/src/ATen/native/cuda/Loss.cu:245: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [1,0,0] Assertion `t >= 0 && t < n_classes` failed.
/pytorch/aten/src/ATen/native/cuda/Loss.cu:245: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [2,0,0] Assertion `t >= 0 && t < n_classes` failed.
<string>:4: UserWarning: ComplexHalf support is experimental and many operators don't support it yet. (Triggered internally at /pytorch/aten/src/ATen/EmptyTensor.cpp:55.)
======================================================================
üî¨ HYBRID STRATEGY BENCHMARK + POISON INJECTION
======================================================================
API: torch.nn.CrossEntropyLoss
Max Iterations: 3,500
Strategy: Œµ-greedy (10% exploration) + Adaptive Mutation
üß™ Poison Injection: 5% Inf + 5% NaN + 10% Extreme
üéØ Precision Tolerance: 1e-06
Oracles: CRASH + CUDA + PRECISION
======================================================================
üìù Config: /data1/tzh/FreeFuzz-baseline/FreeFuzz/src/config/demo_torch.conf
[Patch] üß™ Poison Injection enabled (ALL strategies):
        Float: 5% Inf + 5% NaN + 10% Extreme
        Int:   10% boundary + 10% extreme + 10% trap

======================================================================
PHASE 1: RANDOM BASELINE (All Oracles + Poison)
======================================================================
[Fuzzer] üéØ Precision tolerance: diff_bound=1e-06
[Fuzzer] Using ALL oracles: CRASH + CUDA + PRECISION
[Logger] Trace file: poison_batch_20251216_020449/torch_nn_CrossEntropyLoss/random/torch_nn_CrossEntropyLoss_random_trace.jsonl
[Checkpoint] Manager initialized: torch_nn_CrossEntropyLoss_random_checkpoint.pkl
[Safety] Guards enabled: Speedometer + DiskGuard + OutlierFilter

[Fuzzer] Initialized: Random
  API: torch.nn.CrossEntropyLoss
  Patches: Disabled
  Hybrid Strategy: N/A
  Data Logging: Enabled
  Checkpoint: Enabled
  Safety Guards: Enabled

======================================================================
Starting Random fuzzing
Iterations: 0 ‚Üí 3500
======================================================================


--- Checkpoint: 175/3500 (0.1 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.4%
Speed: 77.51 it/s (avg: 49.65) | Elapsed: 3s | ETA: 1m 6s
Disk: 1939.31 GB free (81.0% used)
Filter: 1/175 filtered (0.6%)

--- Checkpoint: 350/3500 (0.1 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.7%
Speed: 71.55 it/s (avg: 59.34) | Elapsed: 5s | ETA: 53s
Disk: 1939.31 GB free (81.0% used)
Filter: 1/350 filtered (0.3%)

--- Checkpoint: 525/3500 (0.1 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.6%
Speed: 69.62 it/s (avg: 62.73) | Elapsed: 8s | ETA: 47s
Disk: 1939.31 GB free (81.0% used)
Filter: 2/525 filtered (0.4%)

--- Checkpoint: 700/3500 (0.2 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.7%
Speed: 73.35 it/s (avg: 64.86) | Elapsed: 10s | ETA: 43s
Disk: 1939.31 GB free (81.0% used)
Filter: 2/700 filtered (0.3%)

--- Checkpoint: 875/3500 (0.2 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.7%
Speed: 64.91 it/s (avg: 64.94) | Elapsed: 13s | ETA: 40s
Disk: 1939.30 GB free (81.0% used)
Filter: 3/875 filtered (0.3%)

--- Checkpoint: 1050/3500 (0.3 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.7%
Speed: 60.12 it/s (avg: 64.48) | Elapsed: 16s | ETA: 38s
Disk: 1939.30 GB free (81.0% used)
Filter: 3/1050 filtered (0.3%)

--- Checkpoint: 1225/3500 (0.3 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.8%
Speed: 66.18 it/s (avg: 64.58) | Elapsed: 18s | ETA: 35s
Disk: 1939.30 GB free (81.0% used)
Filter: 3/1225 filtered (0.2%)

--- Checkpoint: 1400/3500 (0.4 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.8%
Speed: 61.30 it/s (avg: 64.24) | Elapsed: 21s | ETA: 32s
Disk: 1939.30 GB free (81.0% used)
Filter: 3/1400 filtered (0.2%)

--- Checkpoint: 1575/3500 (0.4 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.8%
Speed: 63.02 it/s (avg: 64.03) | Elapsed: 24s | ETA: 30s
Disk: 1939.30 GB free (81.0% used)
Filter: 3/1575 filtered (0.2%)

--- Checkpoint: 1750/3500 (0.5 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.8%
Speed: 51.81 it/s (avg: 62.99) | Elapsed: 27s | ETA: 27s
Disk: 1939.29 GB free (81.0% used)
Filter: 3/1750 filtered (0.2%)

--- Checkpoint: 1925/3500 (0.5 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.8%
Speed: 61.04 it/s (avg: 62.33) | Elapsed: 30s | ETA: 25s
Disk: 1939.29 GB free (81.0% used)
Filter: 4/1925 filtered (0.2%)

--- Checkpoint: 2100/3500 (0.6 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.8%
Speed: 50.78 it/s (avg: 61.29) | Elapsed: 34s | ETA: 22s
Disk: 1939.29 GB free (81.0% used)
Filter: 4/2100 filtered (0.2%)

--- Checkpoint: 2275/3500 (0.6 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.8%
Speed: 46.80 it/s (avg: 59.88) | Elapsed: 37s | ETA: 20s
Disk: 1939.29 GB free (81.0% used)
Filter: 4/2275 filtered (0.2%)

--- Checkpoint: 2450/3500 (0.7 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.8%
Speed: 50.18 it/s (avg: 59.09) | Elapsed: 41s | ETA: 17s
Disk: 1939.29 GB free (81.0% used)
Filter: 4/2450 filtered (0.2%)

--- Checkpoint: 2625/3500 (0.8 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.8%
Speed: 48.42 it/s (avg: 58.32) | Elapsed: 45s | ETA: 15s
Disk: 1939.28 GB free (81.0% used)
Filter: 4/2625 filtered (0.2%)

--- Checkpoint: 2800/3500 (0.8 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.9%
Speed: 44.93 it/s (avg: 57.05) | Elapsed: 49s | ETA: 12s
Disk: 1939.28 GB free (81.0% used)
Filter: 4/2800 filtered (0.1%)

--- Checkpoint: 2975/3500 (0.9 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.9%
Speed: 48.71 it/s (avg: 56.39) | Elapsed: 52s | ETA: 9s
Disk: 1939.28 GB free (81.0% used)
Filter: 4/2975 filtered (0.1%)

--- Checkpoint: 3150/3500 (0.9 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.9%
Speed: 49.37 it/s (avg: 55.99) | Elapsed: 56s | ETA: 6s
Disk: 1939.28 GB free (81.0% used)
Filter: 4/3150 filtered (0.1%)

--- Checkpoint: 3325/3500 (1.0 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.9%
Speed: 45.61 it/s (avg: 55.36) | Elapsed: 1m 0s | ETA: 3s
Disk: 1939.28 GB free (81.0% used)
Filter: 4/3325 filtered (0.1%)

--- Checkpoint: 3500/3500 (1.1 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.8%
Speed: 44.47 it/s (avg: 54.75) | Elapsed: 1m 3s | ETA: 0s
Disk: 1939.27 GB free (81.0% used)
Filter: 6/3500 filtered (0.2%)
[Checkpoint] Cleared

======================================================================
Fuzzing completed: Random
Total time: 1.1 minutes
Valid Rate: 99.8%
Trace file: poison_batch_20251216_020449/torch_nn_CrossEntropyLoss/random/torch_nn_CrossEntropyLoss_random_trace.jsonl
Average Speed: 54.75 it/s
Final Disk Usage: 1939.27 GB free
Outliers Filtered: 6/3500
======================================================================

======================================================================
FINAL STATISTICS: Random
======================================================================
Total Kernels: 0

======================================================================
BUG DETECTION SUMMARY: Random
======================================================================
Total Bugs Found:    0
  üî• CRASH:          0
  üîÄ CUDA:           0
  ‚ö° PRECISION:      0
======================================================================

======================================================================
PHASE 2: KERNEL-GUIDED WITH HYBRID STRATEGY (+ Poison)
======================================================================
[Patch] ‚úÖ Database sampling: 20% ‚Üí 80%
[Fuzzer] üéØ Precision tolerance: diff_bound=1e-06
[Fuzzer] Using ALL oracles: CRASH + CUDA + PRECISION
[Logger] Trace file: poison_batch_20251216_020449/torch_nn_CrossEntropyLoss/guided/torch_nn_CrossEntropyLoss_guided_trace.jsonl
[Checkpoint] Manager initialized: torch_nn_CrossEntropyLoss_guided_checkpoint.pkl
[Safety] Guards enabled: Speedometer + DiskGuard + OutlierFilter

[Fuzzer] Initialized: Guided
  API: torch.nn.CrossEntropyLoss
  Patches: Enabled
  Hybrid Strategy: Active
  Data Logging: Enabled
  Checkpoint: Enabled
  Safety Guards: Enabled
[Patch] ‚úÖ Adaptive range enabled for Guided: ¬±8

======================================================================
Starting Guided fuzzing
Hybrid Strategy: Œµ-greedy + Adaptive Mutation
Iterations: 0 ‚Üí 3500
======================================================================


--- Checkpoint: 175/3500 (0.0 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 72.45 it/s (avg: 71.41) | Elapsed: 2s | ETA: 46s
Disk: 1939.27 GB free (81.0% used)
Filter: 0/175 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 11/175 (6.3%) | Mode: Normal | Œµ=0.10, range=¬±8

--- Checkpoint: 350/3500 (0.1 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 71.84 it/s (avg: 72.40) | Elapsed: 4s | ETA: 43s
Disk: 1939.27 GB free (81.0% used)
Filter: 0/350 filtered (0.0%)
/data1/tzh/FreeFuzz-baseline/FreeFuzz/src/benchmark_full_oracle.py:1429: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
Corpus: 0 seeds
Mutation: Explore: 30/350 (8.6%) | Mode: Normal | Œµ=0.10, range=¬±8

üîç Expanding search (stagnation: 500 iters)
  üîç [Mutation] Expansion mode: Œµ=0.3, range=¬±64

--- Checkpoint: 525/3500 (0.1 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.8%
Speed: 68.07 it/s (avg: 71.39) | Elapsed: 7s | ETA: 41s
Disk: 1939.27 GB free (81.0% used)
Filter: 1/525 filtered (0.2%)
Corpus: 0 seeds
Mutation: Explore: 46/525 (8.8%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 700/3500 (0.2 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.9%
Speed: 68.42 it/s (avg: 68.72) | Elapsed: 10s | ETA: 40s
Disk: 1939.27 GB free (81.0% used)
Filter: 1/700 filtered (0.1%)
Corpus: 0 seeds
Mutation: Explore: 99/700 (14.1%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 875/3500 (0.2 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.5%
Speed: 65.60 it/s (avg: 65.91) | Elapsed: 13s | ETA: 39s
Disk: 1939.26 GB free (81.0% used)
Filter: 4/875 filtered (0.5%)
Corpus: 0 seeds
Mutation: Explore: 153/875 (17.5%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 1050/3500 (0.3 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.5%
Speed: 66.36 it/s (avg: 65.62) | Elapsed: 16s | ETA: 37s
Disk: 1939.26 GB free (81.0% used)
Filter: 5/1050 filtered (0.5%)
Corpus: 0 seeds
Mutation: Explore: 205/1050 (19.5%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 1225/3500 (0.3 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.6%
Speed: 62.39 it/s (avg: 64.86) | Elapsed: 18s | ETA: 35s
Disk: 1939.26 GB free (81.0% used)
Filter: 5/1225 filtered (0.4%)
Corpus: 0 seeds
Mutation: Explore: 250/1225 (20.4%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 1400/3500 (0.4 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.6%
Speed: 59.85 it/s (avg: 63.54) | Elapsed: 22s | ETA: 33s
Disk: 1939.26 GB free (81.0% used)
Filter: 5/1400 filtered (0.4%)
Corpus: 0 seeds
Mutation: Explore: 312/1400 (22.3%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 1575/3500 (0.4 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.6%
Speed: 61.17 it/s (avg: 62.80) | Elapsed: 25s | ETA: 30s
Disk: 1939.26 GB free (81.0% used)
Filter: 6/1575 filtered (0.4%)
Corpus: 0 seeds
Mutation: Explore: 368/1575 (23.4%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 1750/3500 (0.5 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.7%
Speed: 58.39 it/s (avg: 62.44) | Elapsed: 28s | ETA: 28s
Disk: 1939.25 GB free (81.0% used)
Filter: 6/1750 filtered (0.3%)
Corpus: 0 seeds
Mutation: Explore: 426/1750 (24.3%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 1925/3500 (0.5 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.7%
Speed: 56.69 it/s (avg: 61.75) | Elapsed: 31s | ETA: 25s
Disk: 1939.25 GB free (81.0% used)
Filter: 6/1925 filtered (0.3%)
Corpus: 0 seeds
Mutation: Explore: 487/1925 (25.3%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 2100/3500 (0.6 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.7%
Speed: 46.74 it/s (avg: 60.22) | Elapsed: 34s | ETA: 23s
Disk: 1939.25 GB free (81.0% used)
Filter: 6/2100 filtered (0.3%)
Corpus: 0 seeds
Mutation: Explore: 536/2100 (25.5%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 2275/3500 (0.6 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.7%
Speed: 51.35 it/s (avg: 59.59) | Elapsed: 38s | ETA: 20s
Disk: 1939.25 GB free (81.0% used)
Filter: 7/2275 filtered (0.3%)
Corpus: 0 seeds
Mutation: Explore: 591/2275 (26.0%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 2450/3500 (0.7 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.7%
Speed: 51.89 it/s (avg: 58.98) | Elapsed: 41s | ETA: 17s
Disk: 1939.25 GB free (81.0% used)
Filter: 8/2450 filtered (0.3%)
Corpus: 0 seeds
Mutation: Explore: 645/2450 (26.3%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 2625/3500 (0.8 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.7%
Speed: 44.42 it/s (avg: 57.84) | Elapsed: 45s | ETA: 15s
Disk: 1939.24 GB free (81.0% used)
Filter: 8/2625 filtered (0.3%)
Corpus: 0 seeds
Mutation: Explore: 705/2625 (26.9%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 2800/3500 (0.8 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.7%
Speed: 46.44 it/s (avg: 56.92) | Elapsed: 49s | ETA: 12s
Disk: 1939.24 GB free (81.0% used)
Filter: 9/2800 filtered (0.3%)
Corpus: 0 seeds
Mutation: Explore: 762/2800 (27.2%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 2975/3500 (0.9 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.7%
Speed: 43.34 it/s (avg: 56.04) | Elapsed: 53s | ETA: 9s
Disk: 1939.24 GB free (81.0% used)
Filter: 9/2975 filtered (0.3%)
Corpus: 0 seeds
Mutation: Explore: 819/2975 (27.5%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 3150/3500 (1.0 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.7%
Speed: 44.13 it/s (avg: 55.24) | Elapsed: 57s | ETA: 6s
Disk: 1939.24 GB free (81.0% used)
Filter: 9/3150 filtered (0.3%)
Corpus: 0 seeds
Mutation: Explore: 864/3150 (27.4%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 3325/3500 (1.0 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.7%
Speed: 47.30 it/s (avg: 54.62) | Elapsed: 1m 0s | ETA: 3s
Disk: 1939.24 GB free (81.0% used)
Filter: 9/3325 filtered (0.3%)
Corpus: 0 seeds
Mutation: Explore: 922/3325 (27.7%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 3500/3500 (1.1 min) ---
Kernels: 0 | Bugs: 0 | Valid: 99.7%
Speed: 44.25 it/s (avg: 54.04) | Elapsed: 1m 4s | ETA: 0s
Disk: 1939.23 GB free (81.0% used)
Filter: 10/3500 filtered (0.3%)
Corpus: 0 seeds
Mutation: Explore: 975/3500 (27.9%) | Mode: Expansion | Œµ=0.30, range=¬±64
[Checkpoint] Cleared

======================================================================
Fuzzing completed: Guided
Total time: 1.1 minutes
Valid Rate: 99.7%
Trace file: poison_batch_20251216_020449/torch_nn_CrossEntropyLoss/guided/torch_nn_CrossEntropyLoss_guided_trace.jsonl
Average Speed: 54.04 it/s
Final Disk Usage: 1939.23 GB free
Outliers Filtered: 10/3500
Mutation Stats: Explore: 975/3500 (27.9%) | Mode: Expansion | Œµ=0.30, range=¬±64
======================================================================

======================================================================
FINAL STATISTICS: Guided
======================================================================
Total Kernels: 0

======================================================================
BUG DETECTION SUMMARY: Guided
======================================================================
Total Bugs Found:    0
  üî• CRASH:          0
  üîÄ CUDA:           0
  ‚ö° PRECISION:      0
======================================================================
[Patch] üîÑ Database sampling restored
[Patch] üîÑ Adaptive range disabled
[Patch] üîÑ Poison Injection restored

üìä Hybrid strategy plot saved: poison_batch_20251216_020449/torch_nn_CrossEntropyLoss/torch_nn_CrossEntropyLoss_hybrid_strategy.png

üíæ Results saved: poison_batch_20251216_020449/torch_nn_CrossEntropyLoss/torch_nn_CrossEntropyLoss_hybrid_results.json
