/pytorch/aten/src/ATen/native/cuda/Loss.cu:245: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [0,0,0] Assertion `t >= 0 && t < n_classes` failed.
/pytorch/aten/src/ATen/native/cuda/Loss.cu:245: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [1,0,0] Assertion `t >= 0 && t < n_classes` failed.
/pytorch/aten/src/ATen/native/cuda/Loss.cu:245: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [2,0,0] Assertion `t >= 0 && t < n_classes` failed.
<string>:6: UserWarning: ComplexHalf support is experimental and many operators don't support it yet. (Triggered internally at /pytorch/aten/src/ATen/EmptyTensor.cpp:55.)
======================================================================
üî¨ HYBRID STRATEGY BENCHMARK + POISON INJECTION
======================================================================
API: torch.nn.NLLLoss
Max Iterations: 2,000
Strategy: Œµ-greedy (10% exploration) + Adaptive Mutation
üß™ Poison Injection: 5% Inf + 5% NaN + 10% Extreme
üéØ Precision Tolerance: 1e-06
Oracles: CRASH + CUDA + PRECISION
======================================================================
üìù Config: /data1/tzh/FreeFuzz-baseline/FreeFuzz/src/config/demo_torch.conf
[Patch] üß™ Poison Injection enabled: 5% Inf + 5% NaN + 10% Extreme (ALL strategies)

======================================================================
PHASE 1: RANDOM BASELINE (All Oracles + Poison)
======================================================================
[Fuzzer] üéØ Precision tolerance: diff_bound=1e-06
[Fuzzer] Using ALL oracles: CRASH + CUDA + PRECISION
[Logger] Trace file: poison_batch_20251215_212232/torch_nn_NLLLoss/random/torch_nn_NLLLoss_random_trace.jsonl
[Checkpoint] Manager initialized: torch_nn_NLLLoss_random_checkpoint.pkl
[Safety] Guards enabled: Speedometer + DiskGuard + OutlierFilter

[Fuzzer] Initialized: Random
  API: torch.nn.NLLLoss
  Patches: Disabled
  Hybrid Strategy: N/A
  Data Logging: Enabled
  Checkpoint: Enabled
  Safety Guards: Enabled

======================================================================
Starting Random fuzzing
Iterations: 0 ‚Üí 2000
======================================================================


--- Checkpoint: 100/2000 (0.0 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 39.12 it/s (avg: 39.37) | Elapsed: 2s | ETA: 48s
Disk: 1941.04 GB free (81.0% used)
Filter: 0/100 filtered (0.0%)

--- Checkpoint: 200/2000 (0.1 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 91.57 it/s (avg: 55.06) | Elapsed: 3s | ETA: 32s
Disk: 1941.04 GB free (81.0% used)
Filter: 0/200 filtered (0.0%)

--- Checkpoint: 300/2000 (0.1 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 82.91 it/s (avg: 62.02) | Elapsed: 4s | ETA: 27s
Disk: 1941.04 GB free (81.0% used)
Filter: 0/300 filtered (0.0%)

--- Checkpoint: 400/2000 (0.1 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 73.20 it/s (avg: 64.50) | Elapsed: 6s | ETA: 24s
Disk: 1941.04 GB free (81.0% used)
Filter: 0/400 filtered (0.0%)

--- Checkpoint: 500/2000 (0.1 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 71.00 it/s (avg: 65.72) | Elapsed: 7s | ETA: 22s
Disk: 1941.04 GB free (81.0% used)
Filter: 0/500 filtered (0.0%)

--- Checkpoint: 600/2000 (0.2 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 63.24 it/s (avg: 65.33) | Elapsed: 9s | ETA: 21s
Disk: 1941.04 GB free (81.0% used)
Filter: 0/600 filtered (0.0%)

--- Checkpoint: 700/2000 (0.2 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 77.99 it/s (avg: 66.89) | Elapsed: 10s | ETA: 19s
Disk: 1941.04 GB free (81.0% used)
Filter: 0/700 filtered (0.0%)

--- Checkpoint: 800/2000 (0.2 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 78.57 it/s (avg: 68.12) | Elapsed: 11s | ETA: 17s
Disk: 1941.03 GB free (81.0% used)
Filter: 0/800 filtered (0.0%)

--- Checkpoint: 900/2000 (0.2 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 69.55 it/s (avg: 68.20) | Elapsed: 13s | ETA: 16s
Disk: 1941.03 GB free (81.0% used)
Filter: 0/900 filtered (0.0%)

--- Checkpoint: 1000/2000 (0.2 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 70.46 it/s (avg: 68.41) | Elapsed: 14s | ETA: 14s
Disk: 1941.03 GB free (81.0% used)
Filter: 0/1000 filtered (0.0%)

--- Checkpoint: 1100/2000 (0.3 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 68.47 it/s (avg: 68.43) | Elapsed: 16s | ETA: 13s
Disk: 1941.03 GB free (81.0% used)
Filter: 0/1100 filtered (0.0%)

--- Checkpoint: 1200/2000 (0.3 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 55.67 it/s (avg: 67.13) | Elapsed: 17s | ETA: 11s
Disk: 1941.03 GB free (81.0% used)
Filter: 0/1200 filtered (0.0%)

--- Checkpoint: 1300/2000 (0.3 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 60.02 it/s (avg: 66.53) | Elapsed: 19s | ETA: 10s
Disk: 1941.03 GB free (81.0% used)
Filter: 0/1300 filtered (0.0%)

--- Checkpoint: 1400/2000 (0.4 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 63.88 it/s (avg: 66.35) | Elapsed: 21s | ETA: 9s
Disk: 1941.03 GB free (81.0% used)
Filter: 0/1400 filtered (0.0%)

--- Checkpoint: 1500/2000 (0.4 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 62.18 it/s (avg: 66.06) | Elapsed: 22s | ETA: 7s
Disk: 1941.03 GB free (81.0% used)
Filter: 0/1500 filtered (0.0%)

--- Checkpoint: 1600/2000 (0.4 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 57.61 it/s (avg: 65.47) | Elapsed: 24s | ETA: 6s
Disk: 1941.03 GB free (81.0% used)
Filter: 0/1600 filtered (0.0%)

--- Checkpoint: 1700/2000 (0.4 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 61.25 it/s (avg: 65.21) | Elapsed: 26s | ETA: 4s
Disk: 1941.02 GB free (81.0% used)
Filter: 0/1700 filtered (0.0%)

--- Checkpoint: 1800/2000 (0.5 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 66.34 it/s (avg: 65.27) | Elapsed: 27s | ETA: 3s
Disk: 1941.02 GB free (81.0% used)
Filter: 0/1800 filtered (0.0%)

--- Checkpoint: 1900/2000 (0.5 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 64.29 it/s (avg: 65.23) | Elapsed: 29s | ETA: 1s
Disk: 1941.02 GB free (81.0% used)
Filter: 0/1900 filtered (0.0%)

--- Checkpoint: 2000/2000 (0.5 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 62.00 it/s (avg: 65.06) | Elapsed: 30s | ETA: 0s
Disk: 1941.02 GB free (81.0% used)
Filter: 0/2000 filtered (0.0%)
[Checkpoint] Cleared

======================================================================
Fuzzing completed: Random
Total time: 0.5 minutes
Valid Rate: 100.0%
Trace file: poison_batch_20251215_212232/torch_nn_NLLLoss/random/torch_nn_NLLLoss_random_trace.jsonl
Average Speed: 65.03 it/s
Final Disk Usage: 1941.02 GB free
Outliers Filtered: 0/2000
======================================================================

======================================================================
FINAL STATISTICS: Random
======================================================================
Total Kernels: 0

======================================================================
BUG DETECTION SUMMARY: Random
======================================================================
Total Bugs Found:    0
  üî• CRASH:          0
  üîÄ CUDA:           0
  ‚ö° PRECISION:      0
======================================================================

======================================================================
PHASE 2: KERNEL-GUIDED WITH HYBRID STRATEGY (+ Poison)
======================================================================
[Patch] ‚úÖ Database sampling: 20% ‚Üí 80%
[Fuzzer] üéØ Precision tolerance: diff_bound=1e-06
[Fuzzer] Using ALL oracles: CRASH + CUDA + PRECISION
[Logger] Trace file: poison_batch_20251215_212232/torch_nn_NLLLoss/guided/torch_nn_NLLLoss_guided_trace.jsonl
[Checkpoint] Manager initialized: torch_nn_NLLLoss_guided_checkpoint.pkl
[Safety] Guards enabled: Speedometer + DiskGuard + OutlierFilter

[Fuzzer] Initialized: Guided
  API: torch.nn.NLLLoss
  Patches: Enabled
  Hybrid Strategy: Active
  Data Logging: Enabled
  Checkpoint: Enabled
  Safety Guards: Enabled
[Patch] ‚úÖ Adaptive Mutation enabled: range=¬±8 (Guided only)

======================================================================
Starting Guided fuzzing
Hybrid Strategy: Œµ-greedy + Adaptive Mutation
Iterations: 0 ‚Üí 2000
======================================================================


--- Checkpoint: 100/2000 (0.0 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 75.54 it/s (avg: 75.78) | Elapsed: 1s | ETA: 25s
Disk: 1941.02 GB free (81.0% used)
Filter: 0/100 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 9/100 (9.0%) | Mode: Normal | Œµ=0.10, range=¬±8

--- Checkpoint: 200/2000 (0.0 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 64.92 it/s (avg: 69.78) | Elapsed: 2s | ETA: 25s
Disk: 1941.02 GB free (81.0% used)
Filter: 0/200 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 21/200 (10.5%) | Mode: Normal | Œµ=0.10, range=¬±8

--- Checkpoint: 300/2000 (0.1 min) ---
/data1/tzh/FreeFuzz-baseline/FreeFuzz/src/benchmark_full_oracle.py:1412: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 69.95 it/s (avg: 69.71) | Elapsed: 4s | ETA: 24s
Disk: 1941.02 GB free (81.0% used)
Filter: 0/300 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 30/300 (10.0%) | Mode: Normal | Œµ=0.10, range=¬±8

--- Checkpoint: 400/2000 (0.1 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 69.27 it/s (avg: 69.52) | Elapsed: 5s | ETA: 23s
Disk: 1941.02 GB free (81.0% used)
Filter: 0/400 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 43/400 (10.8%) | Mode: Normal | Œµ=0.10, range=¬±8

--- Checkpoint: 500/2000 (0.1 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 81.33 it/s (avg: 71.61) | Elapsed: 6s | ETA: 20s
Disk: 1941.01 GB free (81.0% used)
Filter: 0/500 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 56/500 (11.2%) | Mode: Normal | Œµ=0.10, range=¬±8

üîç Expanding search (stagnation: 501 iters)
  üîç [Mutation] Expansion mode: Œµ=0.3, range=¬±64

--- Checkpoint: 600/2000 (0.1 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 65.39 it/s (avg: 70.50) | Elapsed: 8s | ETA: 19s
Disk: 1941.01 GB free (81.0% used)
Filter: 0/600 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 93/600 (15.5%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 700/2000 (0.2 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 64.39 it/s (avg: 69.57) | Elapsed: 10s | ETA: 18s
Disk: 1941.01 GB free (81.0% used)
Filter: 0/700 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 113/700 (16.1%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 800/2000 (0.2 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 68.39 it/s (avg: 69.40) | Elapsed: 11s | ETA: 17s
Disk: 1941.01 GB free (81.0% used)
Filter: 0/800 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 150/800 (18.8%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 900/2000 (0.2 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 62.52 it/s (avg: 68.56) | Elapsed: 13s | ETA: 16s
Disk: 1941.01 GB free (81.0% used)
Filter: 0/900 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 173/900 (19.2%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 1000/2000 (0.2 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 60.29 it/s (avg: 67.65) | Elapsed: 14s | ETA: 14s
Disk: 1941.01 GB free (81.0% used)
Filter: 0/1000 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 206/1000 (20.6%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 1100/2000 (0.3 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 62.19 it/s (avg: 67.12) | Elapsed: 16s | ETA: 13s
Disk: 1941.01 GB free (81.0% used)
Filter: 0/1100 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 239/1100 (21.7%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 1200/2000 (0.3 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 60.95 it/s (avg: 66.57) | Elapsed: 18s | ETA: 12s
Disk: 1941.01 GB free (81.0% used)
Filter: 0/1200 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 268/1200 (22.3%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 1300/2000 (0.3 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 54.16 it/s (avg: 65.43) | Elapsed: 19s | ETA: 10s
Disk: 1941.01 GB free (81.0% used)
Filter: 0/1300 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 298/1300 (22.9%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 1400/2000 (0.4 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 60.94 it/s (avg: 65.09) | Elapsed: 21s | ETA: 9s
Disk: 1941.00 GB free (81.0% used)
Filter: 0/1400 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 327/1400 (23.4%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 1500/2000 (0.4 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 57.25 it/s (avg: 64.51) | Elapsed: 23s | ETA: 7s
Disk: 1941.00 GB free (81.0% used)
Filter: 0/1500 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 352/1500 (23.5%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 1600/2000 (0.4 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 58.95 it/s (avg: 64.13) | Elapsed: 24s | ETA: 6s
Disk: 1941.00 GB free (81.0% used)
Filter: 0/1600 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 382/1600 (23.9%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 1700/2000 (0.4 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 59.13 it/s (avg: 63.79) | Elapsed: 26s | ETA: 4s
Disk: 1941.00 GB free (81.0% used)
Filter: 0/1700 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 412/1700 (24.2%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 1800/2000 (0.5 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 67.38 it/s (avg: 63.95) | Elapsed: 28s | ETA: 3s
Disk: 1941.00 GB free (81.0% used)
Filter: 0/1800 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 439/1800 (24.4%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 1900/2000 (0.5 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 65.08 it/s (avg: 64.01) | Elapsed: 29s | ETA: 1s
Disk: 1941.00 GB free (81.0% used)
Filter: 0/1900 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 472/1900 (24.8%) | Mode: Expansion | Œµ=0.30, range=¬±64

--- Checkpoint: 2000/2000 (0.5 min) ---
Kernels: 0 | Bugs: 0 | Valid: 100.0%
Speed: 63.00 it/s (avg: 63.97) | Elapsed: 31s | ETA: 0s
Disk: 1941.00 GB free (81.0% used)
Filter: 0/2000 filtered (0.0%)
Corpus: 0 seeds
Mutation: Explore: 497/2000 (24.9%) | Mode: Expansion | Œµ=0.30, range=¬±64
[Checkpoint] Cleared

======================================================================
Fuzzing completed: Guided
Total time: 0.5 minutes
Valid Rate: 100.0%
Trace file: poison_batch_20251215_212232/torch_nn_NLLLoss/guided/torch_nn_NLLLoss_guided_trace.jsonl
Average Speed: 63.97 it/s
Final Disk Usage: 1941.00 GB free
Outliers Filtered: 0/2000
Mutation Stats: Explore: 497/2000 (24.9%) | Mode: Expansion | Œµ=0.30, range=¬±64
======================================================================

======================================================================
FINAL STATISTICS: Guided
======================================================================
Total Kernels: 0

======================================================================
BUG DETECTION SUMMARY: Guided
======================================================================
Total Bugs Found:    0
  üî• CRASH:          0
  üîÄ CUDA:           0
  ‚ö° PRECISION:      0
======================================================================
[Patch] üîÑ Database sampling restored
[Patch] üîÑ Mutations restored
[Patch] üîÑ Poison Injection restored

üìä Hybrid strategy plot saved: poison_batch_20251215_212232/torch_nn_NLLLoss/torch_nn_NLLLoss_hybrid_strategy.png

üíæ Results saved: poison_batch_20251215_212232/torch_nn_NLLLoss/torch_nn_NLLLoss_hybrid_results.json
